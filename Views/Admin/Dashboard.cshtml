@{
    ViewData["Title"] = "Admin Dashboard";
    Layout = "_AdminLayout";
}

<div class="admin-container">
    <div class="admin-sidebar">
        <div class="sidebar-header">
            <h2>Admin Panel</h2>
        </div>
        <nav class="sidebar-nav">
            <ul>
                <li>
                    <a href="#home" class="nav-link active" data-section="home">
                        <i class="fas fa-home"></i>
                        <span>Home Content</span>
                    </a>
                </li>
                <li>
                    <a href="#videos" class="nav-link" data-section="videos">
                        <i class="fas fa-video"></i>
                        <span>Videos</span>
                    </a>
                </li>
                <li>
                    <a href="#skills" class="nav-link" data-section="skills">
                        <i class="fas fa-code"></i>
                        <span>Skills</span>
                    </a>
                </li>
                <li>
                    <a href="#projects" class="nav-link" data-section="projects">
                        <i class="fas fa-project-diagram"></i>
                        <span>Projects</span>
                    </a>
                </li>
                <li>
                    <a href="#about" class="nav-link" data-section="about">
                        <i class="fas fa-user"></i>
                        <span>About</span>
                    </a>
                </li>
            </ul>
        </nav>
        <div class="sidebar-footer">
            <a href="@Url.Action("Logout", "Admin")" class="btn btn-danger btn-block">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </a>
        </div>
    </div>

    <div class="admin-content">
        <div class="content-header">
            <h1>Welcome to Admin Dashboard</h1>
            <p class="text-muted" style="color: #9ca3af !important;">Manage your portfolio content and settings</p>
        </div>

        <div id="home" class="content-section active">
            <!-- Hero Section Card -->
            <div class="card mb-4 mt-3" style="margin-bottom: 1.5rem !important;">
                <div class="card-header">
                    <h5 class="mb-0" style="color: #818cf8 !important;">
                        <i class="fas fa-star"></i>
                        Hero
                    </h5>
                </div>
                <div class="card-body">
                    <p class="text-muted" style="color: #9ca3af !important;">Manage the hero content including title, subtitle, and action buttons.</p>
                    <button class="btn btn-primary" onclick="toggleHeroEdit()">
                        <i class="fas fa-edit"></i>
                        Edit Hero
                    </button>
                    
                    <!-- Hero Edit Form (Hidden by default) -->
                    <div id="heroEditForm" style="display: none; margin-top: 2rem;">
                        <form id="heroForm">
                            <!-- Main Content -->
                            <div class="mb-4">
                                <h5 class="mb-3" style="color: #818cf8 !important;">Main Content</h5>
                                <div class="card">
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="col-md-6 mb-3">
                                                <label for="heroTitle" class="form-label" style="color: #9ca3af !important;">Title</label>
                                                <input type="text" class="form-control" id="heroTitle" name="HeaderTitle" maxlength="100" required style="color: #818cf8 !important; -webkit-text-fill-color: #818cf8 !important;">
                                            </div>
                                            <div class="col-md-6 mb-3">
                                                <label for="heroSubtitle" class="form-label" style="color: #9ca3af !important;">Subtitle</label>
                                                <input type="text" class="form-control" id="heroSubtitle" name="HeaderSubtitle" maxlength="500" required style="color: #818cf8 !important; -webkit-text-fill-color: #818cf8 !important;">
                                            </div>
                                        </div>
                                        <div class="mb-3">
                                            <label for="heroDescription" class="form-label" style="color: #9ca3af !important;">Description</label>
                                            <textarea class="form-control" id="heroDescription" name="HeaderDescription" maxlength="1000" rows="3" style="color: #818cf8 !important; -webkit-text-fill-color: #818cf8 !important;"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Background -->
                            <div class="mb-4">
                                <h5 class="mb-3" style="color: #818cf8 !important;">Background</h5>
                                <div class="card">
                                    <div class="card-body">
                                        <div class="mb-3">
                                            <label for="heroBackgroundImage" class="form-label" style="color: #9ca3af !important;">Background Image URL</label>
                                            <input type="text" class="form-control" id="heroBackgroundImage" name="HeaderBackgroundImageUrl" maxlength="500" style="color: #818cf8 !important; -webkit-text-fill-color: #818cf8 !important;">
                                        </div>
                                        <div class="mb-3">
                                            <label for="heroBackgroundVideo" class="form-label" style="color: #9ca3af !important;">Background Video URL</label>
                                            <input type="text" class="form-control" id="heroBackgroundVideo" name="HeaderBackgroundVideoUrl" maxlength="500" style="color: #818cf8 !important; -webkit-text-fill-color: #818cf8 !important;">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Primary Button -->
                            <div class="mb-4">
                                <h5 class="mb-3" style="color: #818cf8 !important;">Primary Button</h5>
                                <div class="card">
                                    <div class="card-body">
                                        <div class="mb-3">
                                            <label for="heroPrimaryButtonText" class="form-label" style="color: #9ca3af !important;">Button Text</label>
                                            <input type="text" class="form-control" id="heroPrimaryButtonText" name="HeaderPrimaryButtonText" maxlength="50" style="color: #818cf8 !important; -webkit-text-fill-color: #818cf8 !important;">
                                        </div>
                                        <div class="mb-3">
                                            <label for="heroPrimaryButtonUrl" class="form-label" style="color: #9ca3af !important;">Button URL</label>
                                            <input type="text" class="form-control" id="heroPrimaryButtonUrl" name="HeaderPrimaryButtonUrl" maxlength="200" style="color: #818cf8 !important; -webkit-text-fill-color: #818cf8 !important;">
                                        </div>
                                        <div class="form-check">
                                            <input type="checkbox" class="form-check-input" id="showPrimaryButton" name="ShowHeaderPrimaryButton">
                                            <label class="form-check-label" for="showPrimaryButton" style="color: #9ca3af !important;">Show Button</label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Action Buttons -->
                            <div class="d-flex gap-2 justify-content-end">
                                <button type="button" class="btn btn-secondary" onclick="toggleHeroEdit()">
                                    <i class="fas fa-times"></i>
                                    Cancel
                                </button>
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i>
                                    Save Changes
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Features List Section Card -->
            <div class="card mb-4" style="margin-bottom: 1.5rem !important;">
                <div class="card-header">
                    <h5 class="mb-0" style="color: #818cf8 !important;">
                        <i class="fas fa-list"></i>
                        Features List Section
                    </h5>
                </div>
                <div class="card-body">
                    <p class="text-muted" style="color: #9ca3af !important;">Manage the Key Skills & Technologies section with its three feature cards.</p>
                    <div class="row g-3">
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-body">
                                    <h6 class="card-title" style="color: #818cf8 !important;">Frontend Development</h6>
                                    <button class="btn btn-primary btn-sm" onclick="editFeature('frontend')">
                                        <i class="fas fa-edit"></i>
                                        Edit
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-body">
                                    <h6 class="card-title" style="color: #818cf8 !important;">Backend Development</h6>
                                    <button class="btn btn-primary btn-sm" onclick="editFeature('backend')">
                                        <i class="fas fa-edit"></i>
                                        Edit
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-body">
                                    <h6 class="card-title" style="color: #818cf8 !important;">Design & Tools</h6>
                                    <button class="btn btn-primary btn-sm" onclick="editFeature('design')">
                                        <i class="fas fa-edit"></i>
                                        Edit
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CTA Section Card -->
            <div class="card mb-4" style="margin-bottom: 1.5rem !important;">
                <div class="card-header">
                    <h5 class="mb-0" style="color: #818cf8 !important;">
                        <i class="fas fa-bullhorn"></i>
                        Call to Action Section
                    </h5>
                </div>
                <div class="card-body">
                    <p class="text-muted" style="color: #9ca3af !important;">Manage the CTA section content including title and subtitle.</p>
                    <button class="btn btn-primary" onclick="editSection('cta')">
                        <i class="fas fa-edit"></i>
                        Edit CTA Section
                    </button>
                </div>
            </div>

            <!-- Footer Section Card -->
            <div class="card mb-4" style="margin-bottom: 1.5rem !important;">
                <div class="card-header">
                    <h5 class="mb-0" style="color: #818cf8 !important;">
                        <i class="fas fa-shoe-prints"></i>
                        Footer Section
                    </h5>
                </div>
                <div class="card-body">
                    <p class="text-muted" style="color: #9ca3af !important;">Manage the footer content and links.</p>
                    <button class="btn btn-primary" onclick="editSection('footer')">
                        <i class="fas fa-edit"></i>
                        Edit Footer
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Navigation handling
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const navLink = e.target.closest('.nav-link');
                
                if (!navLink) return; // Guard against null
                
                const section = navLink.dataset.section;
                
                // Update active states
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
                
                navLink.classList.add('active');
                
                const targetSection = document.getElementById(section);
                if (targetSection) {
                    targetSection.classList.add('active');
                }
            });
        });

        // Toggle hero edit form
        function toggleHeroEdit() {
            const form = document.getElementById('heroEditForm');
            const editButton = document.querySelector('.btn-primary[onclick="toggleHeroEdit()"]');
            
            if (form.style.display === 'none' || form.style.display === '') {
                // Show form, hide edit button
                editButton.style.opacity = '0';
                editButton.style.transform = 'translateY(-10px)';
                
                setTimeout(() => {
                    editButton.style.display = 'none';
                    form.style.display = 'block';
                    form.style.opacity = '0';
                    form.style.transform = 'translateY(10px)';
                    
                    setTimeout(() => {
                        form.style.opacity = '1';
                        form.style.transform = 'translateY(0)';
                    }, 50);
                }, 200);
            } else {
                // Hide form, show edit button
                form.style.opacity = '0';
                form.style.transform = 'translateY(-10px)';
                
                setTimeout(() => {
                    form.style.display = 'none';
                    editButton.style.display = 'inline-flex';
                    editButton.style.opacity = '0';
                    editButton.style.transform = 'translateY(10px)';
                    
                    setTimeout(() => {
                        editButton.style.opacity = '1';
                        editButton.style.transform = 'translateY(0)';
                    }, 50);
                }, 200);
            }
        }

        // Handle hero form submission
        document.getElementById('heroForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData.entries());
            
            try {
                const response = await fetch('/api/homepage/header', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                if (response.ok) {
                    alert('Hero section updated successfully!');
                    toggleHeroEdit();
                } else {
                    alert('Failed to update hero section. Please try again.');
                }
            } catch (error) {
                console.error('Error:', error);
                alert('An error occurred while updating the hero section.');
            }
        });

        // Content management functions
        function addHomeContent() {
            // TODO: Implement add home content
        }

        function addVideo() {
            // TODO: Implement add video
        }

        function addSkill() {
            // TODO: Implement add skill
        }

        function addProject() {
            // TODO: Implement add project
        }

        function editAbout() {
            // TODO: Implement edit about
        }

        function editSection(sectionId) {
            // TODO: Implement section editing functionality
            console.log(`Editing section: ${sectionId}`);
        }

        function editFeature(featureId) {
            // TODO: Implement feature editing functionality
            console.log(`Editing feature: ${featureId}`);
        }
    </script>
}